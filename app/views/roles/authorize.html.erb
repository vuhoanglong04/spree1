<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <%= form_with(url: set_permissions_role_path(@role), method: :patch, class: "space-y-8") do |form| %>

      <!-- Header -->
      <div class="bg-white rounded-lg shadow-sm border p-6">
        <h1 class="text-2xl font-bold text-gray-900 mb-2">Role Permissions</h1>
        <p class="text-gray-600">Configure permissions for this role by selecting the appropriate checkboxes below.</p>
      </div>

      <!-- Permissions Grid -->
      <div class="bg-white rounded-lg shadow-sm border p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-6">Permissions by Module</h2>

        <div class="grid gap-6">
          <% @permissions.each do |subject, subject_permissions| %>
            <div class="border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors">
              <h3 class="text-base font-medium text-gray-900 mb-4 pb-2 border-b border-gray-100 capitalize flex items-center">
                <span class="w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium mr-3">
                  <%= subject.first.upcase %>
                </span>
                <%= subject.humanize %>
              </h3>

              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
                <% subject_permissions.each do |permission| %>
                  <label class="flex items-center p-3 border border-gray-200 rounded-md hover:bg-gray-50 hover:border-gray-300 cursor-pointer transition-all group">
                    <%= form.check_box :permission_ids,
                                       {
                                         multiple: true,
                                         checked: @role.permissions.include?(permission),
                                         class: "rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2 mr-3"
                                       },
                                       permission.id,
                                       "" %>
                    <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 capitalize">
                      <%= permission.action.humanize %>
                    </span>
                  </label>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="bg-white rounded-lg shadow-sm border p-6">
        <div class="flex items-center justify-between">
          <div class="text-sm text-gray-500">
            <i class="fas fa-info-circle mr-1"></i>
            Changes will be saved when you submit the form
          </div>

          <div class="flex items-center space-x-3">
            <%= link_to "Cancel", roles_path, class: "px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors" %>
            <%= form.submit "Save Permissions", class: "px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors shadow-sm" %>
          </div>
        </div>
      </div>

    <% end %>
  </div>
</div>

